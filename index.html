<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DRB Advisory Analytics</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --drb-orange: #F26522;
            --drb-navy: #1E2A3A;
            --drb-charcoal: #333333;
            --drb-blue: #3B82F6;
            --drb-green: #10B981;
            --drb-red: #EF4444;
            --drb-yellow: #F59E0B;
            --gray-50: #F8FAFC;
            --gray-100: #F1F5F9;
            --gray-200: #E2E8F0;
            --gray-400: #94A3B8;
            --gray-500: #64748B;
            --gray-600: #475569;
            --gray-700: #334155;
            --gray-800: #1E293B;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background-color: var(--gray-50);
            color: var(--gray-800);
            line-height: 1.5;
        }

        /* Layout */
        .app-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 260px;
            background-color: var(--drb-navy);
            padding: 1.5rem 1rem;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 1.5rem;
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--drb-orange);
        }

        .logo-subtitle {
            color: rgba(255,255,255,0.5);
            font-size: 0.75rem;
        }

        .nav-section-title {
            color: rgba(255,255,255,0.4);
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 0.75rem;
        }

        .nav-item {
            display: block;
            width: 100%;
            padding: 0.65rem 0.75rem;
            margin: 0.1rem 0;
            border: none;
            border-radius: 0.5rem;
            background: transparent;
            color: rgba(255,255,255,0.7);
            font-size: 0.875rem;
            font-weight: 500;
            text-align: left;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .nav-item:hover {
            background: rgba(255,255,255,0.08);
            color: rgba(255,255,255,0.95);
        }

        .nav-item.active {
            background: rgba(242, 101, 34, 0.15);
            color: var(--drb-orange);
            border-left: 3px solid var(--drb-orange);
        }

        .sidebar-divider {
            border-top: 1px solid rgba(255,255,255,0.1);
            margin: 1rem 0;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 0;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--drb-orange);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .user-name {
            color: white;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .user-role {
            color: rgba(255,255,255,0.5);
            font-size: 0.75rem;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 260px;
            padding: 2rem;
            min-height: 100vh;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Typography */
        h1 {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--drb-navy);
            margin-bottom: 0.25rem;
        }

        h2 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 1rem;
        }

        h3 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray-700);
            margin-bottom: 0.75rem;
        }

        .page-subtitle {
            color: var(--gray-500);
            font-size: 0.875rem;
            margin-bottom: 1.5rem;
        }

        /* Cards */
        .card {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: 0.75rem;
            padding: 1.25rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.04);
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .card-grid-4 {
            grid-template-columns: repeat(4, 1fr);
        }

        .card-grid-6 {
            grid-template-columns: repeat(6, 1fr);
        }

        /* Status Cards */
        .status-card {
            border-radius: 1rem;
            padding: 1.25rem;
            border-left: 4px solid;
        }

        .status-card.green {
            background: linear-gradient(135deg, #ECFDF5 0%, #D1FAE5 100%);
            border-left-color: var(--drb-green);
        }

        .status-card.blue {
            background: linear-gradient(135deg, #EFF6FF 0%, #DBEAFE 100%);
            border-left-color: var(--drb-blue);
        }

        .status-card.yellow {
            background: linear-gradient(135deg, #FFFBEB 0%, #FEF3C7 100%);
            border-left-color: var(--drb-yellow);
        }

        .status-card.red {
            background: linear-gradient(135deg, #FEF2F2 0%, #FEE2E2 100%);
            border-left-color: var(--drb-red);
        }

        .status-card-label {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.025em;
            margin-bottom: 0.25rem;
        }

        .status-card.green .status-card-label { color: #059669; }
        .status-card.blue .status-card-label { color: #2563EB; }
        .status-card.yellow .status-card-label { color: #D97706; }
        .status-card.red .status-card-label { color: #DC2626; }

        .status-card-value {
            font-size: 2.5rem;
            font-weight: 700;
            line-height: 1.1;
        }

        .status-card.green .status-card-value { color: #065F46; }
        .status-card.blue .status-card-value { color: #1E40AF; }
        .status-card.yellow .status-card-value { color: #92400E; }
        .status-card.red .status-card-value { color: #991B1B; }

        .status-card-footer {
            font-size: 0.8rem;
            margin-top: 0.25rem;
        }

        .status-card.green .status-card-footer { color: #047857; }
        .status-card.blue .status-card-footer { color: #1D4ED8; }
        .status-card.yellow .status-card-footer { color: #B45309; }
        .status-card.red .status-card-footer { color: #B91C1C; }

        /* KPI Cards */
        .kpi-card {
            text-align: center;
            padding: 1rem;
        }

        .kpi-value {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--gray-800);
        }

        .kpi-value.green { color: var(--drb-green); }
        .kpi-value.red { color: var(--drb-red); }
        .kpi-value.yellow { color: var(--drb-yellow); }

        .kpi-label {
            font-size: 0.75rem;
            color: var(--gray-500);
            margin-top: 0.25rem;
        }

        /* Metric Cards (smaller) */
        .metric-card {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: 0.5rem;
            padding: 1rem;
            border-left: 4px solid var(--gray-200);
        }

        .metric-card.critical { border-left-color: var(--drb-red); }
        .metric-card.warning { border-left-color: var(--drb-orange); }
        .metric-card.info { border-left-color: var(--drb-blue); }
        .metric-card.success { border-left-color: var(--drb-green); }

        .metric-label {
            font-size: 0.75rem;
            color: var(--gray-500);
        }

        .metric-value {
            font-size: 1.75rem;
            font-weight: 700;
        }

        .metric-card.critical .metric-value { color: #DC2626; }
        .metric-card.warning .metric-value { color: #EA580C; }
        .metric-card.info .metric-value { color: #2563EB; }
        .metric-card.success .metric-value { color: #059669; }

        /* Customer Header */
        .customer-header {
            background: linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%);
            border: 1px solid var(--gray-200);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .customer-info h2 {
            margin-bottom: 0.25rem;
        }

        .customer-meta {
            color: var(--gray-500);
            font-size: 0.875rem;
        }

        .customer-stats {
            display: flex;
            gap: 2rem;
        }

        .customer-stat {
            text-align: center;
        }

        .customer-stat-label {
            font-size: 0.7rem;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .customer-stat-value {
            font-size: 1.75rem;
            font-weight: 700;
        }

        .customer-stat-value.green { color: var(--drb-green); }
        .customer-stat-value.yellow { color: var(--drb-yellow); }
        .customer-stat-value.red { color: var(--drb-red); }

        /* Tables */
        .table-container {
            overflow-x: auto;
            margin-top: 1rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }

        th {
            background: var(--gray-50);
            padding: 0.75rem 1rem;
            text-align: left;
            font-weight: 600;
            color: var(--gray-600);
            border-bottom: 2px solid var(--gray-200);
        }

        td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid var(--gray-100);
        }

        tr:hover {
            background: var(--gray-50);
        }

        .badge {
            display: inline-block;
            padding: 0.2rem 0.6rem;
            border-radius: 9999px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .badge.critical {
            background: #FEE2E2;
            color: #DC2626;
        }

        .badge.warning {
            background: #FFEDD5;
            color: #EA580C;
        }

        .badge.healthy, .badge.success {
            background: #D1FAE5;
            color: #059669;
        }

        .badge.info {
            background: #DBEAFE;
            color: #2563EB;
        }

        /* Form Controls */
        .form-row {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .form-group {
            flex: 1;
            min-width: 200px;
        }

        .form-group label {
            display: block;
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--gray-600);
            margin-bottom: 0.25rem;
        }

        select, input[type="text"], input[type="number"] {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--gray-200);
            border-radius: 0.5rem;
            font-size: 0.875rem;
            background: white;
        }

        select:focus, input:focus {
            outline: none;
            border-color: var(--drb-orange);
            box-shadow: 0 0 0 3px rgba(242, 101, 34, 0.1);
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .btn-primary {
            background: var(--drb-orange);
            color: white;
        }

        .btn-primary:hover {
            background: #E55A1B;
        }

        .btn-secondary {
            background: var(--gray-100);
            color: var(--gray-700);
        }

        .btn-secondary:hover {
            background: var(--gray-200);
        }

        /* Charts */
        .chart-container {
            position: relative;
            height: 280px;
            margin-top: 1rem;
        }

        .chart-container.small {
            height: 200px;
        }

        .charts-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .charts-row-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        /* Alert Cards */
        .alert-card {
            border-left: 4px solid;
            padding: 1rem 1.25rem;
            border-radius: 0.75rem;
            margin-bottom: 0.75rem;
            background: white;
        }

        .alert-card.critical {
            border-left-color: var(--drb-red);
            background: linear-gradient(135deg, #FEF2F2 0%, #FFFFFF 100%);
        }

        .alert-card.warning {
            border-left-color: var(--drb-orange);
            background: linear-gradient(135deg, #FFF7ED 0%, #FFFFFF 100%);
        }

        .alert-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .alert-title {
            font-weight: 600;
            color: var(--gray-800);
        }

        .alert-customer {
            color: var(--gray-600);
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .alert-message {
            color: var(--gray-500);
            font-size: 0.85rem;
        }

        /* Benchmark Cards */
        .benchmark-card {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: 1rem;
            padding: 1.5rem;
        }

        .benchmark-card h3 {
            margin-bottom: 1rem;
        }

        .benchmark-row {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--gray-100);
        }

        .benchmark-row:last-child {
            border-bottom: none;
        }

        .benchmark-label {
            color: var(--gray-500);
        }

        .benchmark-value {
            font-weight: 600;
            color: var(--gray-800);
        }

        .benchmark-value.green { color: var(--drb-green); }
        .benchmark-value.red { color: var(--drb-red); }

        /* Footer */
        .footer {
            text-align: center;
            padding: 1.5rem;
            border-top: 1px solid var(--gray-100);
            color: var(--gray-400);
            font-size: 0.8rem;
            margin-top: 2rem;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .card-grid-6 {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }

            .main-content {
                margin-left: 0;
            }

            .card-grid-4, .card-grid-6 {
                grid-template-columns: repeat(2, 1fr);
            }

            .charts-row {
                grid-template-columns: 1fr;
            }

            .customer-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">
                <span class="logo-text">DRB</span>
                <span class="logo-subtitle">Advisory Analytics</span>
            </div>

            <p class="nav-section-title">Dashboard</p>
            <nav>
                <button class="nav-item active" data-page="portfolio">Portfolio Overview</button>
                <button class="nav-item" data-page="operational">Operational Health</button>
                <button class="nav-item" data-page="alerts">Risk Alerts</button>
                <button class="nav-item" data-page="boap">Business on a Page</button>
                <button class="nav-item" data-page="deepdive">Advisory Deep Dive</button>
                <button class="nav-item" data-page="benchmarks">Industry Benchmarks</button>
                <button class="nav-item" data-page="settings">Alert Configuration</button>
            </nav>

            <div class="sidebar-divider"></div>

            <div class="user-info">
                <div class="user-avatar">MJ</div>
                <div>
                    <div class="user-name">Mike Johnson</div>
                    <div class="user-role">Customer Success</div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Portfolio Overview -->
            <div id="portfolio" class="page active">
                <h1>Portfolio Health</h1>
                <p class="page-subtitle">Performance vs. industry benchmarks</p>

                <div class="card-grid card-grid-4">
                    <div class="status-card green">
                        <div class="status-card-label">Outperforming</div>
                        <div class="status-card-value">2</div>
                        <div class="status-card-footer">33% of portfolio</div>
                    </div>
                    <div class="status-card blue">
                        <div class="status-card-label">On Track</div>
                        <div class="status-card-value">1</div>
                        <div class="status-card-footer">17% of portfolio</div>
                    </div>
                    <div class="status-card yellow">
                        <div class="status-card-label">Needs Attention</div>
                        <div class="status-card-value">2</div>
                        <div class="status-card-footer">33% of portfolio</div>
                    </div>
                    <div class="status-card red">
                        <div class="status-card-label">Critical</div>
                        <div class="status-card-value">1</div>
                        <div class="status-card-footer">17% of portfolio</div>
                    </div>
                </div>

                <div class="card">
                    <h2>Customer Overview</h2>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Customer</th>
                                    <th>Sites</th>
                                    <th>Health</th>
                                    <th>Capture %</th>
                                    <th>Churn %</th>
                                    <th>Traffic YoY</th>
                                    <th>Revenue YoY</th>
                                    <th>Status</th>
                                    <th>CSM</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Sparkle Clean Auto Spa</td>
                                    <td>12</td>
                                    <td>28</td>
                                    <td>31%</td>
                                    <td>8.2%</td>
                                    <td>-18%</td>
                                    <td>-18%</td>
                                    <td><span class="badge critical">Critical</span></td>
                                    <td>Mike Johnson</td>
                                </tr>
                                <tr>
                                    <td>Metro Express Wash</td>
                                    <td>8</td>
                                    <td>45</td>
                                    <td>35%</td>
                                    <td>6.5%</td>
                                    <td>-8%</td>
                                    <td>-10%</td>
                                    <td><span class="badge warning">Warning</span></td>
                                    <td>Sarah Chen</td>
                                </tr>
                                <tr>
                                    <td>Shine Time Car Wash</td>
                                    <td>5</td>
                                    <td>72</td>
                                    <td>42%</td>
                                    <td>4.2%</td>
                                    <td>+5%</td>
                                    <td>+6%</td>
                                    <td><span class="badge healthy">Healthy</span></td>
                                    <td>Mike Johnson</td>
                                </tr>
                                <tr>
                                    <td>Quick Clean Express</td>
                                    <td>156</td>
                                    <td>38</td>
                                    <td>33%</td>
                                    <td>7.1%</td>
                                    <td>-12%</td>
                                    <td>-14%</td>
                                    <td><span class="badge warning">Warning</span></td>
                                    <td>Tom Wilson</td>
                                </tr>
                                <tr>
                                    <td>Premier Auto Spa</td>
                                    <td>234</td>
                                    <td>85</td>
                                    <td>48%</td>
                                    <td>3.8%</td>
                                    <td>+12%</td>
                                    <td>+14%</td>
                                    <td><span class="badge healthy">Healthy</span></td>
                                    <td>Sarah Chen</td>
                                </tr>
                                <tr>
                                    <td>Crystal Clear Wash</td>
                                    <td>45</td>
                                    <td>52</td>
                                    <td>38%</td>
                                    <td>5.9%</td>
                                    <td>-3%</td>
                                    <td>-2%</td>
                                    <td><span class="badge info">On Track</span></td>
                                    <td>Tom Wilson</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Operational Health -->
            <div id="operational" class="page">
                <h1>Operational Health</h1>
                <p class="page-subtitle">System performance and support metrics</p>

                <div class="form-row">
                    <div class="form-group">
                        <label>Select Customer</label>
                        <select id="customer-select" onchange="updateOperationalData()">
                            <option value="bmw">BMW Kar Wash LLC (61 sites)</option>
                            <option value="sparkle">Sparkle Clean Auto Spa (12 sites)</option>
                            <option value="quick">Quick Clean Express (156 sites)</option>
                            <option value="premier">Premier Auto Spa (234 sites)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Time Period</label>
                        <select>
                            <option>Last 30 Days</option>
                            <option>Last 60 Days</option>
                            <option>Last 90 Days</option>
                            <option>Year to Date</option>
                        </select>
                    </div>
                    <div class="form-group" style="display: flex; align-items: flex-end;">
                        <button class="btn btn-secondary">Refresh Data</button>
                    </div>
                </div>

                <div class="customer-header">
                    <div class="customer-info">
                        <h2 id="op-customer-name">BMW Kar Wash LLC</h2>
                        <div class="customer-meta" id="op-customer-meta">61 Sites · MI · CSM: Morgan Malone</div>
                    </div>
                    <div class="customer-stats">
                        <div class="customer-stat">
                            <div class="customer-stat-label">Health Index</div>
                            <div class="customer-stat-value green" id="op-health-index">Green</div>
                        </div>
                        <div class="customer-stat">
                            <div class="customer-stat-label">Score</div>
                            <div class="customer-stat-value" id="op-health-score">2.80</div>
                        </div>
                    </div>
                </div>

                <h2>Summary Metrics</h2>
                <div class="card-grid card-grid-6">
                    <div class="card kpi-card">
                        <div class="kpi-value" id="op-uptime">99.92%</div>
                        <div class="kpi-label">Uptime (30d)</div>
                    </div>
                    <div class="card kpi-card">
                        <div class="kpi-value" id="op-total-cases">572</div>
                        <div class="kpi-label">Total Cases (30d)</div>
                    </div>
                    <div class="card kpi-card">
                        <div class="kpi-value" id="op-open-cases">4</div>
                        <div class="kpi-label">Open Cases</div>
                    </div>
                    <div class="card kpi-card">
                        <div class="kpi-value" id="op-avg-ttr">2.24</div>
                        <div class="kpi-label">Avg TTR (Days)</div>
                    </div>
                    <div class="card kpi-card">
                        <div class="kpi-value" id="op-hw-swaps">3</div>
                        <div class="kpi-label">Hardware Swaps</div>
                    </div>
                    <div class="card kpi-card">
                        <div class="kpi-value" id="op-escalations">1</div>
                        <div class="kpi-label">Escalations</div>
                    </div>
                </div>

                <div class="charts-row">
                    <div class="card">
                        <h3>Case Volume by Product</h3>
                        <div class="chart-container">
                            <canvas id="caseByProductChart"></canvas>
                        </div>
                    </div>
                    <div class="card">
                        <h3>Monthly Case Volume</h3>
                        <div class="chart-container">
                            <canvas id="monthlyCaseChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="charts-row">
                    <div class="card">
                        <h3>Monthly Hardware Swaps</h3>
                        <div class="chart-container small">
                            <canvas id="hardwareSwapsChart"></canvas>
                        </div>
                    </div>
                    <div class="card">
                        <h3>Monthly Escalations</h3>
                        <div class="chart-container small">
                            <canvas id="escalationsChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>Site-Level Details</h2>
                    <div class="form-row">
                        <div class="form-group" style="min-width: 150px; flex: 0.5;">
                            <label>Health Status</label>
                            <select>
                                <option>All</option>
                                <option>Healthy</option>
                                <option>Warning</option>
                                <option>Critical</option>
                            </select>
                        </div>
                        <div class="form-group" style="min-width: 150px; flex: 0.5;">
                            <label>City</label>
                            <select>
                                <option>All Cities</option>
                                <option>Detroit</option>
                                <option>Chicago</option>
                                <option>Milwaukee</option>
                            </select>
                        </div>
                        <div class="form-group" style="min-width: 150px; flex: 0.5;">
                            <label>Sort By</label>
                            <select>
                                <option>Cases (30d)</option>
                                <option>Uptime %</option>
                                <option>Open Cases</option>
                                <option>Escalations</option>
                            </select>
                        </div>
                    </div>
                    <div class="table-container">
                        <table id="sites-table">
                            <thead>
                                <tr>
                                    <th>Site</th>
                                    <th>City</th>
                                    <th>Health</th>
                                    <th>Uptime %</th>
                                    <th>Cases (30d)</th>
                                    <th>Open</th>
                                    <th>HW Swaps</th>
                                    <th>Escalations</th>
                                    <th>CSAT</th>
                                    <th>Platform</th>
                                </tr>
                            </thead>
                            <tbody id="sites-table-body">
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-secondary">Export to CSV</button>
                    </div>
                </div>
            </div>

            <!-- Risk Alerts -->
            <div id="alerts" class="page">
                <h1>Risk Alerts</h1>
                <p class="page-subtitle">Automated warning detection</p>

                <div class="card-grid card-grid-4">
                    <div class="metric-card critical">
                        <div class="metric-label">Critical</div>
                        <div class="metric-value">4</div>
                    </div>
                    <div class="metric-card warning">
                        <div class="metric-label">Warning</div>
                        <div class="metric-value">8</div>
                    </div>
                    <div class="metric-card info">
                        <div class="metric-label">New (24h)</div>
                        <div class="metric-value">3</div>
                    </div>
                    <div class="metric-card success">
                        <div class="metric-label">Resolved (7d)</div>
                        <div class="metric-value">6</div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group" style="min-width: 150px; flex: 0.5;">
                        <label>Filter by Severity</label>
                        <select>
                            <option>All</option>
                            <option>Critical</option>
                            <option>Warning</option>
                        </select>
                    </div>
                    <div class="form-group" style="min-width: 150px; flex: 0.5;">
                        <label>Filter by Customer</label>
                        <select>
                            <option>All Customers</option>
                            <option>Sparkle Clean Auto Spa</option>
                            <option>Metro Express Wash</option>
                            <option>Quick Clean Express</option>
                        </select>
                    </div>
                </div>

                <div class="alert-card critical">
                    <div class="alert-header">
                        <span class="alert-title">Traffic Decline</span>
                        <span class="badge critical">CRITICAL</span>
                    </div>
                    <div class="alert-customer">Sparkle Clean Auto Spa</div>
                    <div class="alert-message">Traffic declined 18% YoY across all 12 sites</div>
                </div>

                <div class="alert-card critical">
                    <div class="alert-header">
                        <span class="alert-title">Churn Spike</span>
                        <span class="badge critical">CRITICAL</span>
                    </div>
                    <div class="alert-customer">Sparkle Clean Auto Spa</div>
                    <div class="alert-message">Voluntary churn spiked to 8.2%, up 2.7pts MoM</div>
                </div>

                <div class="alert-card warning">
                    <div class="alert-header">
                        <span class="alert-title">Capture Rate Drop</span>
                        <span class="badge warning">WARNING</span>
                    </div>
                    <div class="alert-customer">Metro Express Wash</div>
                    <div class="alert-message">Capture rate dropped from 41% to 35%</div>
                </div>

                <div class="alert-card warning">
                    <div class="alert-header">
                        <span class="alert-title">Member Loss</span>
                        <span class="badge warning">WARNING</span>
                    </div>
                    <div class="alert-customer">Quick Clean Express</div>
                    <div class="alert-message">Member count down 8% YoY (-340 members)</div>
                </div>

                <div class="alert-card critical">
                    <div class="alert-header">
                        <span class="alert-title">Revenue Decline</span>
                        <span class="badge critical">CRITICAL</span>
                    </div>
                    <div class="alert-customer">Sparkle Clean Auto Spa</div>
                    <div class="alert-message">Revenue declined 18% YoY (-$34K/month)</div>
                </div>
            </div>

            <!-- Business on a Page -->
            <div id="boap" class="page">
                <h1>Business on a Page</h1>
                <p class="page-subtitle">Customer performance summary</p>

                <div class="form-row">
                    <div class="form-group">
                        <label>Select Customer</label>
                        <select id="boap-customer-select">
                            <option>Sparkle Clean Auto Spa</option>
                            <option>Metro Express Wash</option>
                            <option>Shine Time Car Wash</option>
                            <option>Quick Clean Express</option>
                            <option>Premier Auto Spa</option>
                        </select>
                    </div>
                </div>

                <div class="customer-header">
                    <div class="customer-info">
                        <h2>Sparkle Clean Auto Spa</h2>
                        <div class="customer-meta">12 sites · Southwest · CSM: Mike Johnson</div>
                    </div>
                    <div class="customer-stats">
                        <div class="customer-stat">
                            <div class="customer-stat-label">Health Score</div>
                            <div class="customer-stat-value red">28</div>
                        </div>
                        <div class="customer-stat">
                            <div class="customer-stat-label">vs Industry</div>
                            <div class="customer-stat-value red">-24%</div>
                        </div>
                    </div>
                </div>

                <div class="card-grid card-grid-6">
                    <div class="card kpi-card">
                        <div class="kpi-value">31%</div>
                        <div class="kpi-label">Capture Rate</div>
                    </div>
                    <div class="card kpi-card">
                        <div class="kpi-value red">8.2%</div>
                        <div class="kpi-label">Vol Churn</div>
                    </div>
                    <div class="card kpi-card">
                        <div class="kpi-value red">-18%</div>
                        <div class="kpi-label">Traffic YoY</div>
                    </div>
                    <div class="card kpi-card">
                        <div class="kpi-value red">-12%</div>
                        <div class="kpi-label">Members YoY</div>
                    </div>
                    <div class="card kpi-card">
                        <div class="kpi-value red">-18%</div>
                        <div class="kpi-label">Revenue YoY</div>
                    </div>
                    <div class="card kpi-card">
                        <div class="kpi-value">4.1%</div>
                        <div class="kpi-label">Invol Churn</div>
                    </div>
                </div>

                <h2>24-Month Trends</h2>
                <div class="charts-row">
                    <div class="card">
                        <h3>Monthly Revenue ($K)</h3>
                        <div class="chart-container">
                            <canvas id="boapRevenueChart"></canvas>
                        </div>
                    </div>
                    <div class="card">
                        <h3>Active Members</h3>
                        <div class="chart-container">
                            <canvas id="boapMembersChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Advisory Deep Dive -->
            <div id="deepdive" class="page">
                <h1>Advisory Deep Dive</h1>
                <p class="page-subtitle">Detailed analytics by category</p>

                <div class="form-row">
                    <button class="btn btn-primary" id="dd-general">General KPIs</button>
                    <button class="btn btn-secondary" id="dd-membership">Membership</button>
                    <button class="btn btn-secondary" id="dd-retail">Retail</button>
                    <button class="btn btn-secondary" id="dd-marketing">Marketing</button>
                    <button class="btn btn-secondary" id="dd-operations">Operations</button>
                </div>

                <div class="card-grid card-grid-4" style="margin-top: 1.5rem;">
                    <div class="card kpi-card">
                        <div class="kpi-value">$1.87M</div>
                        <div class="kpi-label">Total Revenue</div>
                    </div>
                    <div class="card kpi-card">
                        <div class="kpi-value">101K</div>
                        <div class="kpi-label">Total Cars</div>
                    </div>
                    <div class="card kpi-card">
                        <div class="kpi-value">$28.50</div>
                        <div class="kpi-label">Avg Ticket</div>
                    </div>
                    <div class="card kpi-card">
                        <div class="kpi-value">58%</div>
                        <div class="kpi-label">Member %</div>
                    </div>
                </div>

                <div class="charts-row">
                    <div class="card">
                        <h3>Monthly Revenue ($K)</h3>
                        <div class="chart-container">
                            <canvas id="ddRevenueChart"></canvas>
                        </div>
                    </div>
                    <div class="card">
                        <h3>Cars Washed</h3>
                        <div class="chart-container">
                            <canvas id="ddCarsChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Industry Benchmarks -->
            <div id="benchmarks" class="page">
                <h1>Industry Benchmarks</h1>
                <p class="page-subtitle">Based on 2,400+ car wash locations</p>

                <div class="card-grid" style="grid-template-columns: repeat(3, 1fr);">
                    <div class="benchmark-card">
                        <h3>Membership</h3>
                        <div class="benchmark-row">
                            <span class="benchmark-label">Capture Rate</span>
                            <span class="benchmark-value">39%</span>
                        </div>
                        <div class="benchmark-row">
                            <span class="benchmark-label">Top Quartile</span>
                            <span class="benchmark-value green">48%+</span>
                        </div>
                        <div class="benchmark-row">
                            <span class="benchmark-label">Bottom Quartile</span>
                            <span class="benchmark-value red">&lt;28%</span>
                        </div>
                        <div class="benchmark-row">
                            <span class="benchmark-label">Avg Ticket</span>
                            <span class="benchmark-value">$32.00</span>
                        </div>
                    </div>
                    <div class="benchmark-card">
                        <h3>Churn</h3>
                        <div class="benchmark-row">
                            <span class="benchmark-label">Voluntary</span>
                            <span class="benchmark-value">5.5%</span>
                        </div>
                        <div class="benchmark-row">
                            <span class="benchmark-label">Top Quartile</span>
                            <span class="benchmark-value green">&lt;4.0%</span>
                        </div>
                        <div class="benchmark-row">
                            <span class="benchmark-label">Bottom Quartile</span>
                            <span class="benchmark-value red">7.5%+</span>
                        </div>
                        <div class="benchmark-row">
                            <span class="benchmark-label">Involuntary</span>
                            <span class="benchmark-value">2.5%</span>
                        </div>
                    </div>
                    <div class="benchmark-card">
                        <h3>Traffic</h3>
                        <div class="benchmark-row">
                            <span class="benchmark-label">Growth YoY</span>
                            <span class="benchmark-value">+5%</span>
                        </div>
                        <div class="benchmark-row">
                            <span class="benchmark-label">Top Quartile</span>
                            <span class="benchmark-value green">+12%+</span>
                        </div>
                        <div class="benchmark-row">
                            <span class="benchmark-label">Bottom Quartile</span>
                            <span class="benchmark-value red">&lt;-2%</span>
                        </div>
                        <div class="benchmark-row">
                            <span class="benchmark-label">Member %</span>
                            <span class="benchmark-value">62%</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Alert Configuration -->
            <div id="settings" class="page">
                <h1>Alert Configuration</h1>
                <p class="page-subtitle">Set custom thresholds to trigger alerts</p>

                <div class="card-grid" style="grid-template-columns: repeat(2, 1fr);">
                    <div class="card">
                        <h3>Capture Rate</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Warning (Below)</label>
                                <input type="number" value="35" step="1">
                            </div>
                            <div class="form-group">
                                <label>Critical (Below)</label>
                                <input type="number" value="28" step="1">
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <h3>Voluntary Churn</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Warning (Above)</label>
                                <input type="number" value="6.0" step="0.5">
                            </div>
                            <div class="form-group">
                                <label>Critical (Above)</label>
                                <input type="number" value="7.5" step="0.5">
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <h3>Traffic YoY</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Warning (Below)</label>
                                <input type="number" value="-5" step="1">
                            </div>
                            <div class="form-group">
                                <label>Critical (Below)</label>
                                <input type="number" value="-15" step="1">
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <h3>Revenue YoY</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Warning (Below)</label>
                                <input type="number" value="-5" step="1">
                            </div>
                            <div class="form-group">
                                <label>Critical (Below)</label>
                                <input type="number" value="-12" step="1">
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <h3>Health Score</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Warning (Below)</label>
                                <input type="number" value="50" step="1">
                            </div>
                            <div class="form-group">
                                <label>Critical (Below)</label>
                                <input type="number" value="35" step="1">
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <h3>Average Ticket</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Warning (Below)</label>
                                <input type="number" value="28" step="1">
                            </div>
                            <div class="form-group">
                                <label>Critical (Below)</label>
                                <input type="number" value="24" step="1">
                            </div>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 1.5rem;">
                    <button class="btn btn-primary">Save Configuration</button>
                    <button class="btn btn-secondary" style="margin-left: 0.5rem;">Reset to Defaults</button>
                </div>
            </div>

            <div class="footer">
                Data as of: <span id="current-date"></span> · DRB Advisory Analytics
            </div>
        </main>
    </div>

    <script>
        // Navigation
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function() {
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                
                this.classList.add('active');
                document.getElementById(this.dataset.page).classList.add('active');
                
                // Initialize charts when page becomes visible
                if (this.dataset.page === 'operational') {
                    initOperationalCharts();
                } else if (this.dataset.page === 'boap') {
                    initBoapCharts();
                } else if (this.dataset.page === 'deepdive') {
                    initDeepDiveCharts();
                }
            });
        });

        // Set current date
        document.getElementById('current-date').textContent = new Date().toLocaleDateString('en-US', { 
            year: 'numeric', month: 'long', day: 'numeric' 
        });

        // Sample data
        const customerData = {
            bmw: {
                name: 'BMW Kar Wash LLC',
                sites: 61,
                region: 'MI',
                csm: 'Morgan Malone',
                health: 'Green',
                score: 2.80,
                uptime: '99.92%',
                totalCases: 572,
                openCases: 4,
                avgTtr: 2.24,
                hwSwaps: 3,
                escalations: 1
            },
            sparkle: {
                name: 'Sparkle Clean Auto Spa',
                sites: 12,
                region: 'AZ',
                csm: 'Mike Johnson',
                health: 'Red',
                score: 1.20,
                uptime: '97.45%',
                totalCases: 89,
                openCases: 8,
                avgTtr: 4.5,
                hwSwaps: 5,
                escalations: 3
            },
            quick: {
                name: 'Quick Clean Express',
                sites: 156,
                region: 'TX',
                csm: 'Tom Wilson',
                health: 'Green',
                score: 3.50,
                uptime: '99.78%',
                totalCases: 1240,
                openCases: 12,
                avgTtr: 1.8,
                hwSwaps: 8,
                escalations: 2
            },
            premier: {
                name: 'Premier Auto Spa',
                sites: 234,
                region: 'CA',
                csm: 'Sarah Chen',
                health: 'Green',
                score: 4.20,
                uptime: '99.95%',
                totalCases: 1890,
                openCases: 6,
                avgTtr: 1.2,
                hwSwaps: 4,
                escalations: 0
            }
        };

        // Generate sites data
        function generateSitesData(numSites) {
            const cities = ['Detroit', 'Chicago', 'Milwaukee', 'Cleveland', 'Indianapolis'];
            const platforms = ['SW & PATH', 'SW Only', 'PATH Only', 'XPT & SW'];
            const sites = [];
            
            for (let i = 1; i <= Math.min(numSites, 20); i++) {
                const health = Math.random() > 0.8 ? 'warning' : Math.random() > 0.95 ? 'critical' : 'healthy';
                sites.push({
                    name: `Location ${i}`,
                    city: cities[Math.floor(Math.random() * cities.length)],
                    health: health,
                    uptime: (95 + Math.random() * 5).toFixed(2),
                    cases: Math.floor(Math.random() * 25),
                    open: Math.floor(Math.random() * 5),
                    swaps: Math.floor(Math.random() * 3),
                    escalations: Math.floor(Math.random() * 2),
                    csat: (85 + Math.random() * 15).toFixed(1),
                    platform: platforms[Math.floor(Math.random() * platforms.length)]
                });
            }
            return sites;
        }

        function updateOperationalData() {
            const select = document.getElementById('customer-select');
            const data = customerData[select.value];
            
            document.getElementById('op-customer-name').textContent = data.name;
            document.getElementById('op-customer-meta').textContent = `${data.sites} Sites · ${data.region} · CSM: ${data.csm}`;
            document.getElementById('op-health-index').textContent = data.health;
            document.getElementById('op-health-index').className = `customer-stat-value ${data.health.toLowerCase()}`;
            document.getElementById('op-health-score').textContent = data.score.toFixed(2);
            document.getElementById('op-uptime').textContent = data.uptime;
            document.getElementById('op-total-cases').textContent = data.totalCases;
            document.getElementById('op-open-cases').textContent = data.openCases;
            document.getElementById('op-avg-ttr').textContent = data.avgTtr;
            document.getElementById('op-hw-swaps').textContent = data.hwSwaps;
            document.getElementById('op-escalations').textContent = data.escalations;
            
            // Update sites table
            const sites = generateSitesData(data.sites);
            const tbody = document.getElementById('sites-table-body');
            tbody.innerHTML = sites.map(site => `
                <tr>
                    <td>${site.name}</td>
                    <td>${site.city}</td>
                    <td><span class="badge ${site.health}">${site.health}</span></td>
                    <td>${site.uptime}%</td>
                    <td>${site.cases}</td>
                    <td>${site.open}</td>
                    <td>${site.swaps}</td>
                    <td>${site.escalations}</td>
                    <td>${site.csat}%</td>
                    <td>${site.platform}</td>
                </tr>
            `).join('');
        }

        // Chart instances
        let caseByProductChart, monthlyCaseChart, hardwareSwapsChart, escalationsChart;
        let boapRevenueChart, boapMembersChart;
        let ddRevenueChart, ddCarsChart;

        // Generate months
        function getMonthLabels(count) {
            const months = [];
            const now = new Date();
            for (let i = count - 1; i >= 0; i--) {
                const d = new Date(now.getFullYear(), now.getMonth() - i, 1);
                months.push(d.toLocaleDateString('en-US', { month: 'short', year: '2-digit' }));
            }
            return months;
        }

        // Chart options
        const chartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { display: false }
            },
            scales: {
                x: {
                    grid: { display: false }
                },
                y: {
                    grid: { color: '#F1F5F9', drawBorder: false }
                }
            }
        };

        function initOperationalCharts() {
            const months = getMonthLabels(12);
            
            // Case by Product Chart
            if (caseByProductChart) caseByProductChart.destroy();
            caseByProductChart = new Chart(document.getElementById('caseByProductChart'), {
                type: 'bar',
                data: {
                    labels: ['XPT/Kiosk', 'Cashier', 'Gate', 'TunnelWatch', 'Server', 'XCC', 'OTT', 'ARM'],
                    datasets: [{
                        data: [572, 157, 119, 111, 110, 57, 51, 44],
                        backgroundColor: '#3B82F6',
                        borderRadius: 4
                    }]
                },
                options: {
                    ...chartOptions,
                    indexAxis: 'y'
                }
            });

            // Monthly Case Chart
            if (monthlyCaseChart) monthlyCaseChart.destroy();
            monthlyCaseChart = new Chart(document.getElementById('monthlyCaseChart'), {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [{
                        data: [85, 92, 78, 95, 110, 88, 76, 102, 98, 115, 89, 95],
                        borderColor: '#3B82F6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: chartOptions
            });

            // Hardware Swaps Chart
            if (hardwareSwapsChart) hardwareSwapsChart.destroy();
            hardwareSwapsChart = new Chart(document.getElementById('hardwareSwapsChart'), {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [{
                        data: [2, 1, 3, 2, 4, 1, 2, 3, 1, 2, 3, 2],
                        borderColor: '#F26522',
                        backgroundColor: 'rgba(242, 101, 34, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: chartOptions
            });

            // Escalations Chart
            if (escalationsChart) escalationsChart.destroy();
            escalationsChart = new Chart(document.getElementById('escalationsChart'), {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [{
                        data: [1, 0, 2, 1, 1, 2, 0, 1, 2, 1, 0, 1],
                        borderColor: '#EF4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: chartOptions
            });

            // Initialize sites table
            updateOperationalData();
        }

        function initBoapCharts() {
            const months = getMonthLabels(24);
            
            if (boapRevenueChart) boapRevenueChart.destroy();
            boapRevenueChart = new Chart(document.getElementById('boapRevenueChart'), {
                type: 'bar',
                data: {
                    labels: months,
                    datasets: [{
                        data: Array.from({length: 24}, (_, i) => 180 - i * 3 + Math.random() * 20),
                        backgroundColor: '#F26522',
                        borderRadius: 4
                    }]
                },
                options: chartOptions
            });

            if (boapMembersChart) boapMembersChart.destroy();
            boapMembersChart = new Chart(document.getElementById('boapMembersChart'), {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [{
                        data: Array.from({length: 24}, (_, i) => 2400 - i * 50 + Math.random() * 100),
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: chartOptions
            });
        }

        function initDeepDiveCharts() {
            const months = getMonthLabels(24);
            
            if (ddRevenueChart) ddRevenueChart.destroy();
            ddRevenueChart = new Chart(document.getElementById('ddRevenueChart'), {
                type: 'bar',
                data: {
                    labels: months,
                    datasets: [{
                        data: Array.from({length: 24}, () => 150 + Math.random() * 50),
                        backgroundColor: '#F26522',
                        borderRadius: 4
                    }]
                },
                options: chartOptions
            });

            if (ddCarsChart) ddCarsChart.destroy();
            ddCarsChart = new Chart(document.getElementById('ddCarsChart'), {
                type: 'bar',
                data: {
                    labels: months,
                    datasets: [{
                        data: Array.from({length: 24}, () => 8000 + Math.random() * 4000),
                        backgroundColor: '#3B82F6',
                        borderRadius: 4
                    }]
                },
                options: chartOptions
            });
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            // Default page is portfolio, no charts needed
        });
    </script>
</body>
</html>
